#!/bin/sh

GIT_HOME=${HOME}/.git

echo 'Installing dependencies..'
pacman \
  --sync \
  --upgrade \
  --refresh \
  --needed \
  --noconfirm \
  git rsync curl openssh 

[[ -z $(git --git-dir ${HOME}/.git status -s) ]] || echo "${HOME} is not clean! exiting.."; exit 1

TMP_DOTFILES=$(mktemp --directory)

git clone https://github.com/simonwjackson/dotfiles.git ${TMP_DOTFILES}

rm -rdf "${GIT_HOME}"
rsync --verbose --archive --recursive ${TMP_DOTFILES}/ ${HOME}

rm -rdf ${TMP_DOTFILES}
